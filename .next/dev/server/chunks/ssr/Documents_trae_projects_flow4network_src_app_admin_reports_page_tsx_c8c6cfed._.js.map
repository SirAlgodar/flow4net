{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/gabrieldesouza/Documents/trae_projects/flow4network/src/app/admin/reports/page.tsx"],"sourcesContent":["\n'use client';\n\nimport { useState, useEffect } from 'react';\nimport { \n  BarChart, \n  Bar, \n  XAxis, \n  YAxis, \n  CartesianGrid, \n  Tooltip, \n  Legend, \n  ResponsiveContainer,\n  PieChart, \n  Pie, \n  Cell\n} from 'recharts';\nimport { \n  Loader2, \n  Download, \n  Calendar, \n  Share2, \n  Activity, \n  Users, \n  CheckCircle,\n  Clock\n} from 'lucide-react';\n\nconst COLORS = ['#0088FE', '#00C49F', '#FFBB28', '#FF8042'];\n\nexport default function ReportsPanel() {\n  const [data, setData] = useState<any>(null);\n  const [loading, setLoading] = useState(true);\n  const [range, setRange] = useState('30days');\n\n  const fetchReports = async () => {\n    setLoading(true);\n    try {\n      const res = await fetch(`/api/admin/reports?range=${range}`);\n      const json = await res.json();\n      setData(json);\n    } catch (error) {\n      console.error(error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  useEffect(() => {\n    fetchReports();\n  }, [range]);\n\n  const exportCSV = () => {\n    if (!data || !data.chartData) return;\n    \n    const headers = ['Data', 'Testes Realizados'];\n    const rows = data.chartData.map((item: any) => [item.date, item.count]);\n    \n    const csvContent = \"data:text/csv;charset=utf-8,\" \n        + headers.join(\",\") + \"\\n\" \n        + rows.map((e: any[]) => e.join(\",\")).join(\"\\n\");\n        \n    const encodedUri = encodeURI(csvContent);\n    const link = document.createElement(\"a\");\n    link.setAttribute(\"href\", encodedUri);\n    link.setAttribute(\"download\", `relatorio_testes_${range}.csv`);\n    document.body.appendChild(link);\n    link.click();\n    document.body.removeChild(link);\n  };\n\n  if (loading) {\n    return (\n        <div className=\"flex h-96 items-center justify-center\">\n            <Loader2 className=\"animate-spin h-10 w-10 text-blue-600\" />\n        </div>\n    );\n  }\n\n  return (\n    <div className=\"p-6 space-y-6\">\n      <div className=\"flex justify-between items-center flex-wrap gap-4\">\n        <div>\n            <h1 className=\"text-2xl font-bold text-gray-900\">Relatórios & Analytics</h1>\n            <p className=\"text-gray-500\">Visão geral do desempenho do sistema</p>\n        </div>\n        \n        <div className=\"flex gap-2\">\n            <select \n                value={range}\n                onChange={(e) => setRange(e.target.value)}\n                className=\"border rounded-lg px-3 py-2 bg-white text-sm\"\n            >\n                <option value=\"7days\">Últimos 7 dias</option>\n                <option value=\"30days\">Últimos 30 dias</option>\n                <option value=\"90days\">Últimos 3 meses</option>\n            </select>\n            \n            <button \n                onClick={exportCSV}\n                className=\"flex items-center gap-2 px-4 py-2 bg-white border rounded-lg hover:bg-gray-50 text-gray-700 text-sm font-medium\"\n            >\n                <Download size={16} /> Exportar CSV\n            </button>\n            <button className=\"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 text-sm font-medium\">\n                <Share2 size={16} /> Compartilhar\n            </button>\n        </div>\n      </div>\n\n      {/* KPI Cards */}\n      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6\">\n        <div className=\"bg-white p-6 rounded-xl shadow-sm border border-gray-100\">\n            <div className=\"flex justify-between items-start\">\n                <div>\n                    <p className=\"text-sm font-medium text-gray-500\">Total de Testes</p>\n                    <h3 className=\"text-3xl font-bold text-gray-900 mt-2\">{data?.summary.totalTests}</h3>\n                </div>\n                <div className=\"p-3 bg-blue-50 rounded-lg text-blue-600\">\n                    <Activity size={24} />\n                </div>\n            </div>\n            <span className=\"text-xs text-green-600 font-medium mt-4 block\">+12% vs mês anterior</span>\n        </div>\n\n        <div className=\"bg-white p-6 rounded-xl shadow-sm border border-gray-100\">\n            <div className=\"flex justify-between items-start\">\n                <div>\n                    <p className=\"text-sm font-medium text-gray-500\">Resultados Coletados</p>\n                    <h3 className=\"text-3xl font-bold text-gray-900 mt-2\">{data?.summary.totalResults}</h3>\n                </div>\n                <div className=\"p-3 bg-green-50 rounded-lg text-green-600\">\n                    <CheckCircle size={24} />\n                </div>\n            </div>\n            <span className=\"text-xs text-green-600 font-medium mt-4 block\">+5% vs mês anterior</span>\n        </div>\n\n        <div className=\"bg-white p-6 rounded-xl shadow-sm border border-gray-100\">\n            <div className=\"flex justify-between items-start\">\n                <div>\n                    <p className=\"text-sm font-medium text-gray-500\">Testes Ativos</p>\n                    <h3 className=\"text-3xl font-bold text-gray-900 mt-2\">{data?.summary.activeTests}</h3>\n                </div>\n                <div className=\"p-3 bg-purple-50 rounded-lg text-purple-600\">\n                    <Clock size={24} />\n                </div>\n            </div>\n            <span className=\"text-xs text-gray-500 font-medium mt-4 block\">Em tempo real</span>\n        </div>\n\n        <div className=\"bg-white p-6 rounded-xl shadow-sm border border-gray-100\">\n            <div className=\"flex justify-between items-start\">\n                <div>\n                    <p className=\"text-sm font-medium text-gray-500\">Taxa de Conclusão</p>\n                    <h3 className=\"text-3xl font-bold text-gray-900 mt-2\">{data?.summary.completionRate}%</h3>\n                </div>\n                <div className=\"p-3 bg-orange-50 rounded-lg text-orange-600\">\n                    <Users size={24} />\n                </div>\n            </div>\n            <span className=\"text-xs text-red-600 font-medium mt-4 block\">-2% vs mês anterior</span>\n        </div>\n      </div>\n\n      {/* Charts */}\n      <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n        {/* Activity Chart */}\n        <div className=\"bg-white p-6 rounded-xl shadow-sm border border-gray-100\">\n            <h3 className=\"text-lg font-bold text-gray-900 mb-6\">Volume de Testes Diários</h3>\n            <div className=\"h-80\">\n                <ResponsiveContainer width=\"100%\" height=\"100%\">\n                    <BarChart data={data?.chartData}>\n                        <CartesianGrid strokeDasharray=\"3 3\" vertical={false} />\n                        <XAxis dataKey=\"date\" tick={{fontSize: 12}} />\n                        <YAxis tick={{fontSize: 12}} />\n                        <Tooltip />\n                        <Bar dataKey=\"count\" fill=\"#3b82f6\" radius={[4, 4, 0, 0]} name=\"Testes\" />\n                    </BarChart>\n                </ResponsiveContainer>\n            </div>\n        </div>\n\n        {/* Distribution Chart */}\n        <div className=\"bg-white p-6 rounded-xl shadow-sm border border-gray-100\">\n            <h3 className=\"text-lg font-bold text-gray-900 mb-6\">Distribuição por Tipo</h3>\n            <div className=\"h-80 flex items-center justify-center\">\n                <ResponsiveContainer width=\"100%\" height=\"100%\">\n                    <PieChart>\n                        <Pie\n                            data={data?.byType}\n                            cx=\"50%\"\n                            cy=\"50%\"\n                            innerRadius={60}\n                            outerRadius={100}\n                            fill=\"#8884d8\"\n                            paddingAngle={5}\n                            dataKey=\"value\"\n                        >\n                            {data?.byType.map((entry: any, index: number) => (\n                                <Cell key={`cell-${index}`} fill={COLORS[index % COLORS.length]} />\n                            ))}\n                        </Pie>\n                        <Tooltip />\n                        <Legend verticalAlign=\"bottom\" height={36}/>\n                    </PieChart>\n                </ResponsiveContainer>\n            </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}}]
}