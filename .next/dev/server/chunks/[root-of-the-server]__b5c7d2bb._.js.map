{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 70, "column": 0}, "map": {"version":3,"sources":["file:///Users/gabrieldesouza/Documents/trae_projects/flow4network/src/lib/auth.ts"],"sourcesContent":["import jwt from 'jsonwebtoken';\nimport bcrypt from 'bcryptjs';\n\nconst JWT_SECRET = process.env.JWT_SECRET || 'super-secret-key-change-this';\n\nexport interface TokenPayload {\n  userId: string;\n  role: string;\n  username: string;\n}\n\nexport function signToken(payload: TokenPayload, expiresIn: string | number = '8h'): string {\n  return jwt.sign(payload, JWT_SECRET, { expiresIn: expiresIn as any });\n}\n\nexport function verifyToken(token: string): TokenPayload | null {\n  try {\n    return jwt.verify(token, JWT_SECRET) as TokenPayload;\n  } catch (error) {\n    return null;\n  }\n}\n\nexport async function hashPassword(password: string): Promise<string> {\n  return await bcrypt.hash(password, 10);\n}\n\nexport async function comparePassword(password: string, hash: string): Promise<boolean> {\n  return await bcrypt.compare(password, hash);\n}\n"],"names":[],"mappings":";;;;;;;;;;AAAA;AACA;;;AAEA,MAAM,aAAa,QAAQ,GAAG,CAAC,UAAU,IAAI;AAQtC,SAAS,UAAU,OAAqB,EAAE,YAA6B,IAAI;IAChF,OAAO,gMAAG,CAAC,IAAI,CAAC,SAAS,YAAY;QAAE,WAAW;IAAiB;AACrE;AAEO,SAAS,YAAY,KAAa;IACvC,IAAI;QACF,OAAO,gMAAG,CAAC,MAAM,CAAC,OAAO;IAC3B,EAAE,OAAO,OAAO;QACd,OAAO;IACT;AACF;AAEO,eAAe,aAAa,QAAgB;IACjD,OAAO,MAAM,4LAAM,CAAC,IAAI,CAAC,UAAU;AACrC;AAEO,eAAe,gBAAgB,QAAgB,EAAE,IAAY;IAClE,OAAO,MAAM,4LAAM,CAAC,OAAO,CAAC,UAAU;AACxC"}},
    {"offset": {"line": 107, "column": 0}, "map": {"version":3,"sources":["file:///Users/gabrieldesouza/Documents/trae_projects/flow4network/src/app/api/admin/tests/%5Bid%5D/route.ts"],"sourcesContent":["\nimport { NextResponse } from 'next/server';\nimport { PrismaClient } from '@prisma/client';\nimport { verifyToken } from '@/lib/auth';\nimport { cookies } from 'next/headers';\n\nconst prisma = new PrismaClient();\n\nexport async function GET(\n  request: Request,\n  { params }: { params: Promise<{ id: string }> }\n) {\n  try {\n    const cookieStore = await cookies();\n    const token = cookieStore.get('token')?.value;\n\n    if (!token) return NextResponse.json({ error: 'Unauthorized' }, { status: 401 });\n    if (!verifyToken(token)) return NextResponse.json({ error: 'Invalid token' }, { status: 401 });\n\n    const { id } = await params;\n\n    const test = await prisma.testLink.findUnique({\n      where: { id },\n      include: {\n        creator: { select: { name: true, email: true } },\n        results: {\n            orderBy: { createdAt: 'desc' },\n            take: 50 // Limit to last 50 results for performance\n        },\n        _count: { select: { results: true } }\n      }\n    });\n\n    if (!test) {\n        return NextResponse.json({ error: 'Test not found' }, { status: 404 });\n    }\n\n    return NextResponse.json(test);\n\n  } catch (error) {\n    console.error('Error fetching test details:', error);\n    return NextResponse.json({ error: 'Internal Server Error' }, { status: 500 });\n  }\n}\n"],"names":[],"mappings":";;;;AACA;AACA;AACA;AACA;;;;;AAEA,MAAM,SAAS,IAAI,oPAAY;AAExB,eAAe,IACpB,OAAgB,EAChB,EAAE,MAAM,EAAuC;IAE/C,IAAI;QACF,MAAM,cAAc,MAAM,IAAA,0LAAO;QACjC,MAAM,QAAQ,YAAY,GAAG,CAAC,UAAU;QAExC,IAAI,CAAC,OAAO,OAAO,8LAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAe,GAAG;YAAE,QAAQ;QAAI;QAC9E,IAAI,CAAC,IAAA,iLAAW,EAAC,QAAQ,OAAO,8LAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAgB,GAAG;YAAE,QAAQ;QAAI;QAE5F,MAAM,EAAE,EAAE,EAAE,GAAG,MAAM;QAErB,MAAM,OAAO,MAAM,OAAO,QAAQ,CAAC,UAAU,CAAC;YAC5C,OAAO;gBAAE;YAAG;YACZ,SAAS;gBACP,SAAS;oBAAE,QAAQ;wBAAE,MAAM;wBAAM,OAAO;oBAAK;gBAAE;gBAC/C,SAAS;oBACL,SAAS;wBAAE,WAAW;oBAAO;oBAC7B,MAAM,GAAG,2CAA2C;gBACxD;gBACA,QAAQ;oBAAE,QAAQ;wBAAE,SAAS;oBAAK;gBAAE;YACtC;QACF;QAEA,IAAI,CAAC,MAAM;YACP,OAAO,8LAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAiB,GAAG;gBAAE,QAAQ;YAAI;QACxE;QAEA,OAAO,8LAAY,CAAC,IAAI,CAAC;IAE3B,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,gCAAgC;QAC9C,OAAO,8LAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAwB,GAAG;YAAE,QAAQ;QAAI;IAC7E;AACF"}}]
}