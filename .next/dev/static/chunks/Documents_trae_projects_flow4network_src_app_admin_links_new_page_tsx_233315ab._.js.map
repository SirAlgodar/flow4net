{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/gabrieldesouza/Documents/trae_projects/flow4network/src/app/admin/links/new/page.tsx"],"sourcesContent":["'use client';\n\nimport { useState } from 'react';\nimport { useForm } from 'react-hook-form';\nimport { zodResolver } from '@hookform/resolvers/zod';\nimport { z } from 'zod';\nimport { useRouter } from 'next/navigation';\nimport { Loader2, Link as LinkIcon, Save, Copy, Check, ArrowLeft } from 'lucide-react';\nimport Link from 'next/link';\n\nconst formSchema = z.object({\n  type: z.enum(['QUICK', 'IDENTIFIED', 'UNIDENTIFIED']),\n  code: z.string().optional(),\n  expiresAt: z.string().optional(),\n  cpfCnpj: z.string().optional(),\n  config: z.object({\n    allowSpeedTest: z.boolean(),\n    allowPing: z.boolean(),\n    allowTraceroute: z.boolean(),\n    allowVideo: z.boolean(),\n    allowVoip: z.boolean(),\n    allowWeb: z.boolean(),\n  }),\n});\n\ntype FormData = z.infer<typeof formSchema>;\n\nexport default function NewLinkPage() {\n  const router = useRouter();\n  const [loading, setLoading] = useState(false);\n  const [createdLink, setCreatedLink] = useState<string | null>(null);\n  const [copied, setCopied] = useState(false);\n  const [error, setError] = useState('');\n\n  const { register, handleSubmit, watch, formState: { errors } } = useForm<FormData>({\n    resolver: zodResolver(formSchema),\n    defaultValues: {\n      type: 'QUICK',\n      config: {\n        allowSpeedTest: true,\n        allowPing: true,\n        allowTraceroute: true,\n        allowVideo: true,\n        allowVoip: true,\n        allowWeb: true,\n      }\n    }\n  });\n\n  const selectedType = watch('type');\n\n  const onSubmit = async (data: FormData) => {\n    setLoading(true);\n    setError('');\n    setCreatedLink(null);\n    try {\n      const res = await fetch('/api/admin/links', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify(data),\n      });\n\n      const result = await res.json();\n\n      if (!res.ok) {\n        throw new Error(result.error || 'Erro ao criar link');\n      }\n\n      const linkUrl = `${window.location.origin}/t/${result.link.code}`;\n      setCreatedLink(linkUrl);\n\n    } catch (err: any) {\n      setError(err.message);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const copyToClipboard = () => {\n    if (createdLink) {\n      navigator.clipboard.writeText(createdLink);\n      setCopied(true);\n      setTimeout(() => setCopied(false), 2000);\n    }\n  };\n\n  return (\n    <div className=\"space-y-6 max-w-4xl mx-auto p-6\">\n      <div className=\"flex items-center gap-4 mb-6\">\n        <Link href=\"/admin\" className=\"text-gray-500 hover:text-gray-700\">\n          <ArrowLeft size={24} />\n        </Link>\n        <h1 className=\"text-2xl font-bold text-gray-900\">Gerar Novo Link de Teste</h1>\n      </div>\n\n      {createdLink && (\n        <div className=\"bg-green-50 border border-green-200 rounded-lg p-6 mb-6\">\n          <h3 className=\"text-green-800 font-semibold mb-2 flex items-center gap-2\">\n            <Check className=\"w-5 h-5\" />\n            Link Criado com Sucesso!\n          </h3>\n          <div className=\"flex gap-2\">\n            <input \n              readOnly \n              value={createdLink} \n              className=\"flex-1 p-2 border border-green-300 rounded bg-white text-gray-700\"\n            />\n            <button \n              onClick={copyToClipboard}\n              className=\"px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 flex items-center gap-2\"\n            >\n              {copied ? <Check size={18} /> : <Copy size={18} />}\n              {copied ? 'Copiado' : 'Copiar'}\n            </button>\n          </div>\n          <button \n            onClick={() => { setCreatedLink(null); setError(''); }}\n            className=\"mt-4 text-sm text-green-700 hover:underline\"\n          >\n            Gerar outro link\n          </button>\n        </div>\n      )}\n\n      {!createdLink && (\n        <form onSubmit={handleSubmit(onSubmit)} className=\"bg-white rounded-xl shadow-sm border border-gray-100 p-6 space-y-6\">\n          \n          {error && (\n            <div className=\"bg-red-50 text-red-600 p-4 rounded-lg border border-red-100\">\n              {error}\n            </div>\n          )}\n\n          {/* Tipo de Link */}\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-2\">Tipo de Link</label>\n            <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n              <label className={`\n                relative flex flex-col p-4 border rounded-lg cursor-pointer transition-all\n                ${selectedType === 'IDENTIFIED' ? 'border-blue-500 bg-blue-50' : 'border-gray-200 hover:border-gray-300'}\n              `}>\n                <input type=\"radio\" value=\"IDENTIFIED\" className=\"sr-only\" {...register('type')} />\n                <span className=\"font-semibold text-gray-900\">Identificado pelo Operador</span>\n                <span className=\"text-sm text-gray-500 mt-1\">O operador insere o CPF/CNPJ agora.</span>\n              </label>\n\n              <label className={`\n                relative flex flex-col p-4 border rounded-lg cursor-pointer transition-all\n                ${selectedType === 'QUICK' ? 'border-blue-500 bg-blue-50' : 'border-gray-200 hover:border-gray-300'}\n              `}>\n                <input type=\"radio\" value=\"QUICK\" className=\"sr-only\" {...register('type')} />\n                <span className=\"font-semibold text-gray-900\">Identificado pelo Cliente</span>\n                <span className=\"text-sm text-gray-500 mt-1\">O cliente informa seus dados ao acessar.</span>\n              </label>\n\n              <label className={`\n                relative flex flex-col p-4 border rounded-lg cursor-pointer transition-all\n                ${selectedType === 'UNIDENTIFIED' ? 'border-blue-500 bg-blue-50' : 'border-gray-200 hover:border-gray-300'}\n              `}>\n                <input type=\"radio\" value=\"UNIDENTIFIED\" className=\"sr-only\" {...register('type')} />\n                <span className=\"font-semibold text-gray-900\">Não Identificado</span>\n                <span className=\"text-sm text-gray-500 mt-1\">Gera um link anônimo sem identificação.</span>\n              </label>\n            </div>\n          </div>\n\n          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n            {/* Código Customizado */}\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-1\">Código Personalizado (Opcional)</label>\n              <div className=\"relative\">\n                <LinkIcon className=\"absolute left-3 top-2.5 h-5 w-5 text-gray-400\" />\n                <input \n                  {...register('code')}\n                  type=\"text\" \n                  placeholder=\"Ex: cliente-vip-01\"\n                  className=\"pl-10 w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                />\n              </div>\n              <p className=\"text-xs text-gray-500 mt-1\">Deixe em branco para gerar automaticamente.</p>\n            </div>\n\n            {/* Expiração */}\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-1\">Expiração (Opcional)</label>\n              <input \n                {...register('expiresAt')}\n                type=\"datetime-local\"\n                className=\"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n              />\n            </div>\n          </div>\n\n          {/* CPF/CNPJ Condicional */}\n          {selectedType === 'IDENTIFIED' && (\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-1\">CPF/CNPJ do Cliente</label>\n              <input \n                {...register('cpfCnpj')}\n                type=\"text\" \n                placeholder=\"000.000.000-00\"\n                className=\"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n              />\n              {errors.cpfCnpj && <p className=\"text-red-500 text-sm mt-1\">{errors.cpfCnpj.message}</p>}\n            </div>\n          )}\n\n          {/* Configurações de Teste */}\n          <div className=\"border-t pt-6\">\n            <h3 className=\"text-lg font-medium text-gray-900 mb-4\">Configurações do Teste</h3>\n            <div className=\"grid grid-cols-2 md:grid-cols-3 gap-4\">\n              <label className=\"flex items-center space-x-3 p-3 border rounded-lg hover:bg-gray-50 cursor-pointer\">\n                <input type=\"checkbox\" {...register('config.allowSpeedTest')} className=\"h-5 w-5 text-blue-600 rounded\" />\n                <span className=\"text-gray-700\">Velocidade (Speedtest)</span>\n              </label>\n              <label className=\"flex items-center space-x-3 p-3 border rounded-lg hover:bg-gray-50 cursor-pointer\">\n                <input type=\"checkbox\" {...register('config.allowPing')} className=\"h-5 w-5 text-blue-600 rounded\" />\n                <span className=\"text-gray-700\">Latência (Ping)</span>\n              </label>\n              <label className=\"flex items-center space-x-3 p-3 border rounded-lg hover:bg-gray-50 cursor-pointer\">\n                <input type=\"checkbox\" {...register('config.allowTraceroute')} className=\"h-5 w-5 text-blue-600 rounded\" />\n                <span className=\"text-gray-700\">Rota (Traceroute)</span>\n              </label>\n              <label className=\"flex items-center space-x-3 p-3 border rounded-lg hover:bg-gray-50 cursor-pointer\">\n                <input type=\"checkbox\" {...register('config.allowVideo')} className=\"h-5 w-5 text-blue-600 rounded\" />\n                <span className=\"text-gray-700\">Streaming de Vídeo</span>\n              </label>\n              <label className=\"flex items-center space-x-3 p-3 border rounded-lg hover:bg-gray-50 cursor-pointer\">\n                <input type=\"checkbox\" {...register('config.allowVoip')} className=\"h-5 w-5 text-blue-600 rounded\" />\n                <span className=\"text-gray-700\">VoIP</span>\n              </label>\n              <label className=\"flex items-center space-x-3 p-3 border rounded-lg hover:bg-gray-50 cursor-pointer\">\n                <input type=\"checkbox\" {...register('config.allowWeb')} className=\"h-5 w-5 text-blue-600 rounded\" />\n                <span className=\"text-gray-700\">Navegação Web</span>\n              </label>\n            </div>\n          </div>\n\n          <div className=\"pt-4 flex justify-end\">\n            <button\n              type=\"submit\"\n              disabled={loading}\n              className=\"bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 focus:ring-4 focus:ring-blue-200 font-medium flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed transition-all\"\n            >\n              {loading ? <Loader2 className=\"animate-spin\" /> : <Save size={20} />}\n              {loading ? 'Gerando...' : 'Gerar Link'}\n            </button>\n          </div>\n        </form>\n      )}\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;;;AARA;;;;;;;;AAUA,MAAM,aAAa,mOAAC,CAAC,MAAM,CAAC;IAC1B,MAAM,mOAAC,CAAC,IAAI,CAAC;QAAC;QAAS;QAAc;KAAe;IACpD,MAAM,mOAAC,CAAC,MAAM,GAAG,QAAQ;IACzB,WAAW,mOAAC,CAAC,MAAM,GAAG,QAAQ;IAC9B,SAAS,mOAAC,CAAC,MAAM,GAAG,QAAQ;IAC5B,QAAQ,mOAAC,CAAC,MAAM,CAAC;QACf,gBAAgB,mOAAC,CAAC,OAAO;QACzB,WAAW,mOAAC,CAAC,OAAO;QACpB,iBAAiB,mOAAC,CAAC,OAAO;QAC1B,YAAY,mOAAC,CAAC,OAAO;QACrB,WAAW,mOAAC,CAAC,OAAO;QACpB,UAAU,mOAAC,CAAC,OAAO;IACrB;AACF;AAIe,SAAS;;IACtB,MAAM,SAAS,IAAA,gMAAS;IACxB,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,uNAAQ,EAAC;IACvC,MAAM,CAAC,aAAa,eAAe,GAAG,IAAA,uNAAQ,EAAgB;IAC9D,MAAM,CAAC,QAAQ,UAAU,GAAG,IAAA,uNAAQ,EAAC;IACrC,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,uNAAQ,EAAC;IAEnC,MAAM,EAAE,QAAQ,EAAE,YAAY,EAAE,KAAK,EAAE,WAAW,EAAE,MAAM,EAAE,EAAE,GAAG,IAAA,0NAAO,EAAW;QACjF,UAAU,IAAA,8NAAW,EAAC;QACtB,eAAe;YACb,MAAM;YACN,QAAQ;gBACN,gBAAgB;gBAChB,WAAW;gBACX,iBAAiB;gBACjB,YAAY;gBACZ,WAAW;gBACX,UAAU;YACZ;QACF;IACF;IAEA,MAAM,eAAe,MAAM;IAE3B,MAAM,WAAW,OAAO;QACtB,WAAW;QACX,SAAS;QACT,eAAe;QACf,IAAI;YACF,MAAM,MAAM,MAAM,MAAM,oBAAoB;gBAC1C,QAAQ;gBACR,SAAS;oBAAE,gBAAgB;gBAAmB;gBAC9C,MAAM,KAAK,SAAS,CAAC;YACvB;YAEA,MAAM,SAAS,MAAM,IAAI,IAAI;YAE7B,IAAI,CAAC,IAAI,EAAE,EAAE;gBACX,MAAM,IAAI,MAAM,OAAO,KAAK,IAAI;YAClC;YAEA,MAAM,UAAU,GAAG,OAAO,QAAQ,CAAC,MAAM,CAAC,GAAG,EAAE,OAAO,IAAI,CAAC,IAAI,EAAE;YACjE,eAAe;QAEjB,EAAE,OAAO,KAAU;YACjB,SAAS,IAAI,OAAO;QACtB,SAAU;YACR,WAAW;QACb;IACF;IAEA,MAAM,kBAAkB;QACtB,IAAI,aAAa;YACf,UAAU,SAAS,CAAC,SAAS,CAAC;YAC9B,UAAU;YACV,WAAW,IAAM,UAAU,QAAQ;QACrC;IACF;IAEA,qBACE,2OAAC;QAAI,WAAU;;0BACb,2OAAC;gBAAI,WAAU;;kCACb,2OAAC,wNAAI;wBAAC,MAAK;wBAAS,WAAU;kCAC5B,cAAA,2OAAC,8QAAS;4BAAC,MAAM;;;;;;;;;;;kCAEnB,2OAAC;wBAAG,WAAU;kCAAmC;;;;;;;;;;;;YAGlD,6BACC,2OAAC;gBAAI,WAAU;;kCACb,2OAAC;wBAAG,WAAU;;0CACZ,2OAAC,8PAAK;gCAAC,WAAU;;;;;;4BAAY;;;;;;;kCAG/B,2OAAC;wBAAI,WAAU;;0CACb,2OAAC;gCACC,QAAQ;gCACR,OAAO;gCACP,WAAU;;;;;;0CAEZ,2OAAC;gCACC,SAAS;gCACT,WAAU;;oCAET,uBAAS,2OAAC,8PAAK;wCAAC,MAAM;;;;;6DAAS,2OAAC,2PAAI;wCAAC,MAAM;;;;;;oCAC3C,SAAS,YAAY;;;;;;;;;;;;;kCAG1B,2OAAC;wBACC,SAAS;4BAAQ,eAAe;4BAAO,SAAS;wBAAK;wBACrD,WAAU;kCACX;;;;;;;;;;;;YAMJ,CAAC,6BACA,2OAAC;gBAAK,UAAU,aAAa;gBAAW,WAAU;;oBAE/C,uBACC,2OAAC;wBAAI,WAAU;kCACZ;;;;;;kCAKL,2OAAC;;0CACC,2OAAC;gCAAM,WAAU;0CAA+C;;;;;;0CAChE,2OAAC;gCAAI,WAAU;;kDACb,2OAAC;wCAAM,WAAW,CAAC;;gBAEjB,EAAE,iBAAiB,eAAe,+BAA+B,wCAAwC;cAC3G,CAAC;;0DACC,2OAAC;gDAAM,MAAK;gDAAQ,OAAM;gDAAa,WAAU;gDAAW,GAAG,SAAS,OAAO;;;;;;0DAC/E,2OAAC;gDAAK,WAAU;0DAA8B;;;;;;0DAC9C,2OAAC;gDAAK,WAAU;0DAA6B;;;;;;;;;;;;kDAG/C,2OAAC;wCAAM,WAAW,CAAC;;gBAEjB,EAAE,iBAAiB,UAAU,+BAA+B,wCAAwC;cACtG,CAAC;;0DACC,2OAAC;gDAAM,MAAK;gDAAQ,OAAM;gDAAQ,WAAU;gDAAW,GAAG,SAAS,OAAO;;;;;;0DAC1E,2OAAC;gDAAK,WAAU;0DAA8B;;;;;;0DAC9C,2OAAC;gDAAK,WAAU;0DAA6B;;;;;;;;;;;;kDAG/C,2OAAC;wCAAM,WAAW,CAAC;;gBAEjB,EAAE,iBAAiB,iBAAiB,+BAA+B,wCAAwC;cAC7G,CAAC;;0DACC,2OAAC;gDAAM,MAAK;gDAAQ,OAAM;gDAAe,WAAU;gDAAW,GAAG,SAAS,OAAO;;;;;;0DACjF,2OAAC;gDAAK,WAAU;0DAA8B;;;;;;0DAC9C,2OAAC;gDAAK,WAAU;0DAA6B;;;;;;;;;;;;;;;;;;;;;;;;kCAKnD,2OAAC;wBAAI,WAAU;;0CAEb,2OAAC;;kDACC,2OAAC;wCAAM,WAAU;kDAA+C;;;;;;kDAChE,2OAAC;wCAAI,WAAU;;0DACb,2OAAC,2PAAQ;gDAAC,WAAU;;;;;;0DACpB,2OAAC;gDACE,GAAG,SAAS,OAAO;gDACpB,MAAK;gDACL,aAAY;gDACZ,WAAU;;;;;;;;;;;;kDAGd,2OAAC;wCAAE,WAAU;kDAA6B;;;;;;;;;;;;0CAI5C,2OAAC;;kDACC,2OAAC;wCAAM,WAAU;kDAA+C;;;;;;kDAChE,2OAAC;wCACE,GAAG,SAAS,YAAY;wCACzB,MAAK;wCACL,WAAU;;;;;;;;;;;;;;;;;;oBAMf,iBAAiB,8BAChB,2OAAC;;0CACC,2OAAC;gCAAM,WAAU;0CAA+C;;;;;;0CAChE,2OAAC;gCACE,GAAG,SAAS,UAAU;gCACvB,MAAK;gCACL,aAAY;gCACZ,WAAU;;;;;;4BAEX,OAAO,OAAO,kBAAI,2OAAC;gCAAE,WAAU;0CAA6B,OAAO,OAAO,CAAC,OAAO;;;;;;;;;;;;kCAKvF,2OAAC;wBAAI,WAAU;;0CACb,2OAAC;gCAAG,WAAU;0CAAyC;;;;;;0CACvD,2OAAC;gCAAI,WAAU;;kDACb,2OAAC;wCAAM,WAAU;;0DACf,2OAAC;gDAAM,MAAK;gDAAY,GAAG,SAAS,wBAAwB;gDAAE,WAAU;;;;;;0DACxE,2OAAC;gDAAK,WAAU;0DAAgB;;;;;;;;;;;;kDAElC,2OAAC;wCAAM,WAAU;;0DACf,2OAAC;gDAAM,MAAK;gDAAY,GAAG,SAAS,mBAAmB;gDAAE,WAAU;;;;;;0DACnE,2OAAC;gDAAK,WAAU;0DAAgB;;;;;;;;;;;;kDAElC,2OAAC;wCAAM,WAAU;;0DACf,2OAAC;gDAAM,MAAK;gDAAY,GAAG,SAAS,yBAAyB;gDAAE,WAAU;;;;;;0DACzE,2OAAC;gDAAK,WAAU;0DAAgB;;;;;;;;;;;;kDAElC,2OAAC;wCAAM,WAAU;;0DACf,2OAAC;gDAAM,MAAK;gDAAY,GAAG,SAAS,oBAAoB;gDAAE,WAAU;;;;;;0DACpE,2OAAC;gDAAK,WAAU;0DAAgB;;;;;;;;;;;;kDAElC,2OAAC;wCAAM,WAAU;;0DACf,2OAAC;gDAAM,MAAK;gDAAY,GAAG,SAAS,mBAAmB;gDAAE,WAAU;;;;;;0DACnE,2OAAC;gDAAK,WAAU;0DAAgB;;;;;;;;;;;;kDAElC,2OAAC;wCAAM,WAAU;;0DACf,2OAAC;gDAAM,MAAK;gDAAY,GAAG,SAAS,kBAAkB;gDAAE,WAAU;;;;;;0DAClE,2OAAC;gDAAK,WAAU;0DAAgB;;;;;;;;;;;;;;;;;;;;;;;;kCAKtC,2OAAC;wBAAI,WAAU;kCACb,cAAA,2OAAC;4BACC,MAAK;4BACL,UAAU;4BACV,WAAU;;gCAET,wBAAU,2OAAC,6QAAO;oCAAC,WAAU;;;;;yDAAoB,2OAAC,2PAAI;oCAAC,MAAM;;;;;;gCAC7D,UAAU,eAAe;;;;;;;;;;;;;;;;;;;;;;;;AAOxC;GAjOwB;;QACP,gMAAS;QAMyC,0NAAO;;;KAPlD"}}]
}